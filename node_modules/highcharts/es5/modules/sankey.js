/**
 * Highcharts JS v11.2.0 (2023-10-30)
 *
 * Sankey diagram module
 *
 * (c) 2010-2021 Torstein Honsi
 *
 * License: www.highcharts.com/license
 */!function(o){"object"==typeof module&&module.exports?(o.default=o,module.exports=o):"function"==typeof define&&define.amd?define("highcharts/modules/sankey",["highcharts"],function(t){return o(t),o.Highcharts=t,o}):o("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){"use strict";var t=o?o._modules:{};function e(o,t,e,i){o.hasOwnProperty(t)||(o[t]=i.apply(null,e),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:o[t]}})))}e(t,"Series/NodesComposition.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(o,t){var e,i=o.series,n=i.prototype,r=i.prototype.pointClass.prototype,s=t.defined,a=t.extend,l=t.find,d=t.merge,p=t.pick;return function(o){var e=[];function i(){return this.data=[].concat(this.points||[],this.nodes),n.destroy.apply(this,arguments)}function h(){this.nodes&&(this.nodes.forEach(function(o){o.destroy()}),this.nodes.length=0),n.setData.apply(this,arguments)}function c(o){var t=arguments,e=this.isNode?this.linksTo.concat(this.linksFrom):[this.fromNode,this.toNode];"select"!==o&&e.forEach(function(o){o&&o.series&&(r.setState.apply(o,t),!o.isNode&&(o.fromNode.graphic&&r.setState.apply(o.fromNode,t),o.toNode&&o.toNode.graphic&&r.setState.apply(o.toNode,t)))}),r.setState.apply(this,t)}function u(o,t,e,i){var n=this,s=this.series.options.nodes,a=this.series.options.data,l=a&&a.length||0,h=a&&a[this.index];if(r.update.call(this,o,!this.isNode&&t,e,i),this.isNode){var c=(s||[]).reduce(function(o,t,e){return n.id===t.id?e:o},-1),u=d(s&&s[c]||{},a&&a[this.index]||{});a&&(h?a[this.index]=h:a.length=l),s?c>=0?s[c]=u:s.push(u):this.series.options.nodes=[u],p(t,!0)&&this.series.chart.redraw(e)}}o.compose=function(o,n){if(t.pushUnique(e,o)){var r=o.prototype;r.setNodeState=c,r.setState=c,r.update=u}if(t.pushUnique(e,n)){var s=n.prototype;s.destroy=i,s.setData=h}return n},o.createNode=function(o){var t,e=this.pointClass,i=function(o,t){return l(o,function(o){return o.id===t})},n=i(this.nodes,o);if(!n){t=this.options.nodes&&i(this.options.nodes,o);var r=new e().init(this,a({className:"highcharts-node",isNode:!0,id:o,y:1},t));r.linksTo=[],r.linksFrom=[],r.getSum=function(){var o=0,t=0;return r.linksTo.forEach(function(t){o+=t.weight||0}),r.linksFrom.forEach(function(o){t+=o.weight||0}),Math.max(o,t)},r.offset=function(o,t){for(var e=0,i=0;i<r[t].length;i++){if(r[t][i]===o)return e;e+=r[t][i].weight}},r.hasShape=function(){var o=0;return r.linksTo.forEach(function(t){t.outgoing&&o++}),!r.linksTo.length||o!==r.linksTo.length},r.index=this.nodes.push(r)-1,n=r}return n.formatPrefix="node",n.name=n.name||n.options.id||"",n.mass=p(n.options.mass,n.options.marker&&n.options.marker.radius,this.options.marker&&this.options.marker.radius,4),n},o.destroy=i,o.generatePoints=function(){var o=this,t=this.chart,e={};n.generatePoints.call(this),this.nodes||(this.nodes=[]),this.colorCounter=0,this.nodes.forEach(function(o){o.linksFrom.length=0,o.linksTo.length=0,o.level=o.options.level}),this.points.forEach(function(i){s(i.from)&&(e[i.from]||(e[i.from]=o.createNode(i.from)),e[i.from].linksFrom.push(i),i.fromNode=e[i.from],t.styledMode?i.colorIndex=p(i.options.colorIndex,e[i.from].colorIndex):i.color=i.options.color||e[i.from].color),s(i.to)&&(e[i.to]||(e[i.to]=o.createNode(i.to)),e[i.to].linksTo.push(i),i.toNode=e[i.to]),i.name=i.name||i.id},this),this.nodeLookup=e},o.setNodeState=c,o.updateNode=u}(e||(e={})),e}),e(t,"Series/Sankey/SankeyPoint.js",[t["Core/Series/Point.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(o,t,e){var i,n=this&&this.__extends||(i=function(o,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o[e]=t[e])})(o,t)},function(o,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=o}i(o,t),o.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),r=t.seriesTypes.column,s=e.defined;return function(t){function e(){var o=null!==t&&t.apply(this,arguments)||this;return o.className=void 0,o.fromNode=void 0,o.level=void 0,o.linkBase=void 0,o.linkColorMode=void 0,o.linksFrom=void 0,o.linksTo=void 0,o.mass=void 0,o.nodeX=void 0,o.nodeY=void 0,o.options=void 0,o.series=void 0,o.toNode=void 0,o}return n(e,t),e.prototype.applyOptions=function(t,e){return o.prototype.applyOptions.call(this,t,e),s(this.options.level)&&(this.options.column=this.column=this.options.level),this},e.prototype.getClassName=function(){return(this.isNode?"highcharts-node ":"highcharts-link ")+o.prototype.getClassName.call(this)},e.prototype.getFromNode=function(){for(var o,t=-1,e=0;e<this.linksTo.length;e++){var i=this.linksTo[e];i.fromNode.column>t&&i.fromNode!==this&&(t=(o=i.fromNode).column)}return{fromNode:o,fromColumn:t}},e.prototype.setNodeColumn=function(){s(this.options.column)||(0===this.linksTo.length?this.column=0:this.column=this.getFromNode().fromColumn+1)},e.prototype.isValid=function(){return this.isNode||"number"==typeof this.weight},e}(r.prototype.pointClass)}),e(t,"Series/Sankey/SankeySeriesDefaults.js",[],function(){return{borderWidth:0,colorByPoint:!0,curveFactor:.33,dataLabels:{enabled:!0,backgroundColor:"none",crop:!1,nodeFormat:void 0,nodeFormatter:function(){return this.point.name},format:void 0,formatter:function(){},inside:!0},inactiveOtherPoints:!0,linkColorMode:"from",linkOpacity:.5,opacity:1,minLinkWidth:0,nodeAlignment:"center",nodeWidth:20,nodePadding:10,showInLegend:!1,states:{hover:{linkOpacity:1,opacity:1},inactive:{linkOpacity:.1,opacity:.1,animation:{duration:50}}},tooltip:{followPointer:!0,headerFormat:'<span style="font-size: 0.8em">{series.name}</span><br/>',pointFormat:"{point.fromNode.name} â†’ {point.toNode.name}: <b>{point.weight}</b><br/>",nodeFormat:"{point.name}: <b>{point.sum}</b><br/>"}}}),e(t,"Series/Sankey/SankeyColumnComposition.js",[t["Core/Utilities.js"]],function(o){var t,e,i,n=o.defined,r=(o.pushUnique,o.relativeLength);return(t=i||(i={})).compose=function(o,t){return o.sankeyColumn=new e(o,t),o},e=function(){function o(o,t){this.points=o,this.series=t}return o.prototype.getTranslationFactor=function(o){for(var t,e,i=this.points,n=i.slice(),r=o.chart,s=o.options.minLinkWidth||0,a=0,l=(r.plotSizeY||0)-(o.options.borderWidth||0)-(i.length-1)*o.nodePadding;i.length;){for(a=l/i.sankeyColumn.sum(),t=!1,e=i.length;e--;)i[e].getSum()*a<s&&(i.splice(e,1),l=Math.max(0,l-s),t=!0);if(!t)break}i.length=0;for(var d=0;d<n.length;d++){var p=n[d];i.push(p)}return a},o.prototype.top=function(o){var t=this.series,e=t.nodePadding,i=this.points.reduce(function(i,n){return i>0&&(i+=e),i+=Math.max(n.getSum()*o,t.options.minLinkWidth||0)},0);return({top:0,center:.5,bottom:1})[t.options.nodeAlignment||"center"]*((t.chart.plotSizeY||0)-i)},o.prototype.left=function(o){var t=this.series,e=t.chart,i=t.options.equalNodes,n=e.inverted?e.plotHeight:e.plotWidth,r=t.nodePadding,s=this.points.reduce(function(e,s){return e>0&&(e+=r),e+=i?n/s.series.nodes.length-r:Math.max(s.getSum()*o,t.options.minLinkWidth||0)},0);return((e.plotSizeX||0)-Math.round(s))/2},o.prototype.sum=function(){return this.points.reduce(function(o,t){return o+t.getSum()},0)},o.prototype.offset=function(o,t){var e,i=this.points,s=this.series,a=s.nodePadding,l=0;if(s.is("organization")&&o.hangsFrom)return{absoluteTop:o.hangsFrom.nodeY};for(var d=0;d<i.length;d++){var p=i[d].getSum(),h=Math.max(p*t,s.options.minLinkWidth||0),c=o.options[s.chart.inverted?"offsetHorizontal":"offsetVertical"],u=o.options.offset||0;if(e=p?h+a:0,i[d]===o)return{relativeTop:l+(n(c)?r(c,h):r(u,e))};l+=e}},o}(),t.SankeyColumnAdditions=e,i}),e(t,"Series/TreeUtilities.js",[t["Core/Color/Color.js"],t["Core/Utilities.js"]],function(o,t){var e=t.extend,i=t.isArray,n=t.isNumber,r=t.isObject,s=t.merge,a=t.pick;return{getColor:function(t,e){var i,n,r,s,l,d,p,h=e.index,c=e.mapOptionsToLevel,u=e.parentColor,f=e.parentColorIndex,m=e.series,v=e.colors,y=e.siblings,g=m.points,k=m.chart.options.chart;return t&&(n=g[t.i],r=c[t.level]||{},n&&r.colorByPoint&&(l=n.index%(v?v.length:k.colorCount),s=v&&v[l]),m.chart.styledMode||(d=a(n&&n.options.color,r&&r.color,s,u&&((i=r&&r.colorVariation)&&"brightness"===i.key&&h&&y?o.parse(u).brighten(i.to*(h/y)).get():u),m.color)),p=a(n&&n.options.colorIndex,r&&r.colorIndex,l,f,e.colorIndex)),{color:d,colorIndex:p}},getLevelOptions:function(o){var t,e,l,d,p,h,c={};if(r(o))for(d=n(o.from)?o.from:1,h=o.levels,e={},t=r(o.defaults)?o.defaults:{},i(h)&&(e=h.reduce(function(o,e){var i,l,p;return r(e)&&n(e.level)&&(l=a((p=s({},e)).levelIsConstant,t.levelIsConstant),delete p.levelIsConstant,delete p.level,r(o[i=e.level+(l?0:d-1)])?s(!0,o[i],p):o[i]=p),o},{})),p=n(o.to)?o.to:1,l=0;l<=p;l++)c[l]=s({},t,r(e[l])?e[l]:{});return c},setTreeValues:function o(t,i){var n=i.before,r=i.idRoot,s=i.mapIdToNode[r],l=!1!==i.levelIsConstant,d=i.points[t.i],p=d&&d.options||{},h=[],c=0;t.levelDynamic=t.level-(l?0:s.level),t.name=a(d&&d.name,""),t.visible=r===t.id||!0===i.visible,"function"==typeof n&&(t=n(t,i)),t.children.forEach(function(n,r){var s=e({},i);e(s,{index:r,siblings:t.children.length,visible:t.visible}),n=o(n,s),h.push(n),n.visible&&(c+=n.val)});var u=a(p.value,c);return t.visible=u>=0&&(c>0||t.visible),t.children=h,t.childrenTotal=c,t.isLeaf=t.visible&&!c,t.val=u,t},updateRootId:function(o){var t,e;return r(o)&&(e=r(o.options)?o.options:{},t=a(o.rootNode,e.rootId,""),r(o.userOptions)&&(o.userOptions.rootId=t),o.rootNode=t),t}}}),e(t,"Series/Sankey/SankeySeries.js",[t["Core/Globals.js"],t["Series/NodesComposition.js"],t["Series/Sankey/SankeyPoint.js"],t["Series/Sankey/SankeySeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Series/Sankey/SankeyColumnComposition.js"],t["Core/Color/Color.js"],t["Series/TreeUtilities.js"],t["Core/Utilities.js"]],function(o,t,e,i,n,r,s,a,l){var d,p=this&&this.__extends||(d=function(o,t){return(d=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o[e]=t[e])})(o,t)},function(o,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=o}d(o,t),o.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),h=n.seriesTypes,c=h.column,u=h.line,f=s.parse,m=a.getLevelOptions,v=l.clamp,y=l.extend,g=l.isObject,k=l.merge,C=l.pick,S=l.relativeLength,b=l.stableSort,N=function(o){function e(){var t=null!==o&&o.apply(this,arguments)||this;return t.colDistance=void 0,t.data=void 0,t.group=void 0,t.nodeLookup=void 0,t.nodePadding=void 0,t.nodes=void 0,t.nodeWidth=void 0,t.options=void 0,t.points=void 0,t.translationFactor=void 0,t}return p(e,o),e.getDLOptions=function(o){var t=g(o.optionsPoint)?o.optionsPoint.dataLabels:{};return k({style:{}},g(o.level)?o.level.dataLabels:{},t)},e.prototype.createNodeColumns=function(){for(var o=[],t=0,e=this.nodes;t<e.length;t++){var i=e[t];i.setNodeColumn(),o[i.column]||(o[i.column]=r.compose([],this)),o[i.column].push(i)}for(var n=0;n<o.length;n++)void 0===o[n]&&(o[n]=r.compose([],this));return o},e.prototype.order=function(o,t){if(void 0===o.level){o.level=t;for(var e=0,i=o.linksFrom;e<i.length;e++){var n=i[e];n.toNode&&this.order(n.toNode,t+1)}}},e.prototype.generatePoints=function(){if(t.generatePoints.apply(this,arguments),this.orderNodes){for(var o=0,e=this.nodes;o<e.length;o++){var i=e[o];0===i.linksTo.length&&this.order(i,0)}b(this.nodes,function(o,t){return o.level-t.level})}},e.prototype.getNodePadding=function(){var o=this.options.nodePadding||0;if(this.nodeColumns){var t=this.nodeColumns.reduce(function(o,t){return Math.max(o,t.length)},0);t*o>this.chart.plotSizeY&&(o=this.chart.plotSizeY/t)}return o},e.prototype.hasData=function(){return!!this.processedXData.length},e.prototype.pointAttribs=function(o,t){if(!o)return{};var e=this,i=o.isNode?o.level:o.fromNode.level,n=e.mapOptionsToLevel[i||0]||{},r=o.options,a=n.states&&n.states[t||""]||{},l=["colorByPoint","borderColor","borderWidth","linkOpacity","opacity"].reduce(function(o,t){return o[t]=C(a[t],r[t],n[t],e.options[t]),o},{}),d=C(a.color,r.color,l.colorByPoint?o.color:n.color);return o.isNode?{fill:d,stroke:l.borderColor,"stroke-width":l.borderWidth,opacity:l.opacity}:{fill:s.parse(d).setOpacity(l.linkOpacity).get()}},e.prototype.drawTracker=function(){c.prototype.drawTracker.call(this,this.points),c.prototype.drawTracker.call(this,this.nodes)},e.prototype.drawPoints=function(){c.prototype.drawPoints.call(this,this.points),c.prototype.drawPoints.call(this,this.nodes)},e.prototype.drawDataLabels=function(){c.prototype.drawDataLabels.call(this,this.points),c.prototype.drawDataLabels.call(this,this.nodes)},e.prototype.translate=function(){this.processedXData||this.processData(),this.generatePoints(),this.nodeColumns=this.createNodeColumns(),this.nodeWidth=S(this.options.nodeWidth,this.chart.plotSizeX);var o=this,t=this.chart,e=this.options,i=this.nodeWidth,n=this.nodeColumns;this.nodePadding=this.getNodePadding(),this.translationFactor=n.reduce(function(t,e){return Math.min(t,e.sankeyColumn.getTranslationFactor(o))},1/0),this.colDistance=(t.plotSizeX-i-e.borderWidth)/Math.max(1,n.length-1),o.mapOptionsToLevel=m({from:1,levels:e.levels,to:n.length-1,defaults:{borderColor:e.borderColor,borderRadius:e.borderRadius,borderWidth:e.borderWidth,color:o.color,colorByPoint:e.colorByPoint,levelIsConstant:!0,linkColor:e.linkColor,linkLineWidth:e.linkLineWidth,linkOpacity:e.linkOpacity,states:e.states}});for(var r=0;r<n.length;r++)for(var s=n[r],a=0;a<s.length;a++){var l=s[a];o.translateNode(l,s)}for(var d=0,p=this.nodes;d<p.length;d++)for(var l=p[d],h=0,c=l.linksFrom;h<c.length;h++){var u=c[h];(u.weight||u.isNull)&&u.to&&(o.translateLink(u),u.allowShadow=!1)}},e.prototype.translateLink=function(o){var t=function(t,e){var i=t.offset(o,e)*s;return Math.min(t.nodeY+i,t.nodeY+(t.shapeArgs&&t.shapeArgs.height||0)-u)},e=o.fromNode,i=o.toNode,n=this.chart,r=n.inverted,s=this.translationFactor,a=this.options,l=C(o.linkColorMode,a.linkColorMode),d=(n.inverted?-this.colDistance:this.colDistance)*a.curveFactor,p=e.nodeX,h=i.nodeX,c=o.outgoing,u=Math.max(o.weight*s,this.options.minLinkWidth),m=t(e,"linksFrom"),v=t(i,"linksTo"),y=this.nodeWidth,g=h>p+y;if(n.inverted&&(m=n.plotSizeY-m,v=(n.plotSizeY||0)-v,y=-y,u=-u,g=p>h),o.shapeType="path",o.linkBase=[m,m+u,v,v+u],g&&"number"==typeof v)o.shapeArgs={d:[["M",p+y,m],["C",p+y+d,m,h-d,v,h,v],["L",h+(c?y:0),v+u/2],["L",h,v+u],["C",h-d,v+u,p+y+d,m+u,p+y,m+u],["Z"]]};else if("number"==typeof v){var k=n.plotHeight-m-u,S=h-20-u,b=h-20,N=p+y,x=N+20,L=x+u,w=m,P=m+u,T=P+20,O=T+k,j=O+20,M=j+u,F=v,W=F+u,_=W+20,D=P-.7*u,z=j+.7*u,I=W-.7*u,Y=h-.7*u,X=N+.7*u;o.shapeArgs={d:[["M",N,w],["C",X,w,L,D,L,T],["L",L,O],["C",L,z,X,M,N,M],["L",h,M],["C",Y,M,S,z,S,O],["L",S,_],["C",S,I,Y,F,h,F],["L",h,W],["C",b,W,b,W,b,_],["L",b,O],["C",b,j,b,j,h,j],["L",N,j],["C",x,j,x,j,x,O],["L",x,T],["C",x,P,x,P,N,P],["Z"]]}}if(o.dlBox={x:p+(h-p+y)/2,y:m+(v-m)/2,height:u,width:0},o.tooltipPos=n.inverted?[n.plotSizeY-o.dlBox.y-u/2,n.plotSizeX-o.dlBox.x]:[o.dlBox.x,o.dlBox.y+u/2],o.y=o.plotY=1,o.x=o.plotX=1,!o.options.color){if("from"===l)o.color=e.color;else if("to"===l)o.color=i.color;else if("gradient"===l){var A=f(e.color).get(),B=f(i.color).get();o.color={linearGradient:{x1:1,x2:0,y1:0,y2:0},stops:[[0,r?A:B],[1,r?B:A]]}}}},e.prototype.translateNode=function(o,t){var i=this.translationFactor,n=this.chart,r=this.options,s=r.borderRadius,a=r.borderWidth,l=void 0===a?0:a,d=o.getSum(),p=Math.max(Math.round(d*i),this.options.minLinkWidth),h=Math.round(this.nodeWidth),c=Math.round(l)%2/2,u=t.sankeyColumn.offset(o,i),f=Math.floor(C(u.absoluteTop,t.sankeyColumn.top(i)+u.relativeTop))+c,m=Math.floor(this.colDistance*o.column+l/2)+S(o.options[n.inverted?"offsetVertical":"offsetHorizontal"]||0,h)+c,y=n.inverted?n.plotSizeX-m:m;if(o.sum=d,d){o.shapeType="roundedRect",o.nodeX=y,o.nodeY=f;var g=y,k=f,b=o.options.width||r.width||h,N=o.options.height||r.height||p,x=v(S("object"==typeof s?s.radius:s||0,b),0,p/2);n.inverted&&(g=y-h,k=n.plotSizeY-f-p,b=o.options.height||r.height||h,N=o.options.width||r.width||p),o.dlOptions=e.getDLOptions({level:this.mapOptionsToLevel[o.level],optionsPoint:o.options}),o.plotX=1,o.plotY=1,o.tooltipPos=n.inverted?[n.plotSizeY-k-N/2,n.plotSizeX-g-b/2]:[g+b/2,k+N/2],o.shapeArgs={x:g,y:k,width:b,height:N,r:x,display:o.hasShape()?"":"none"}}else o.dlOptions={enabled:!1}},e.defaultOptions=k(c.defaultOptions,i),e}(c);return t.compose(e,N),y(N.prototype,{animate:u.prototype.animate,createNode:t.createNode,forceDL:!0,invertible:!0,isCartesian:!1,orderNodes:!0,noSharedTooltip:!0,pointArrayMap:["from","to","weight"],pointClass:e,searchPoint:o.noop}),n.registerSeriesType("sankey",N),N}),e(t,"masters/modules/sankey.src.js",[],function(){})});//# sourceMappingURL=sankey.js.map